#!/bin/sh

# Laravel Cursor Rules Pre-Commit Hook
# This hook checks for Cursor AI rule updates before each commit

echo "üîç Checking Cursor rules..."

# Run the Laravel command to check for updates
php artisan cursor:rules-update

# Check if the command succeeded
if [ $? -ne 0 ]; then
    echo "‚ö†Ô∏è  Warning: Failed to check for Cursor rules updates"
    echo "Proceeding with commit anyway..."
    exit 0
fi

# Check if rules were updated but not staged
if [ -n "$(git status --porcelain .cursor/rules/)" ]; then
    echo ""
    echo "‚ö†Ô∏è  Cursor rules were updated but not staged!"
    echo "üìù Please review and stage the changes:"
    echo "   git add .cursor/rules/"
    echo "   git commit --amend --no-edit"
    echo ""
    echo "Or to skip this check, run:"
    echo "   git commit --no-verify"
    echo ""
    exit 1
fi

exit 0
